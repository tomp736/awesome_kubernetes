name: 'Deploy TF Plan Test'

on:
  workflow_dispatch:
  push:
    ignore-branches:
    - main
    - dev
    paths:
      - '!**/README.md'

permissions:
  contents: read

jobs:
  deploy:
    uses: ./.github/workflows/deploy.yml
    with:
      TF_WORKSPACE: none
      TF_MODULES_REF: ${{ github.head_ref || github.ref_name }}
      ANSIBLE_MODULES_REF: ${{ github.head_ref || github.ref_name }}
      FLUX_WORKSPACE: ${{ github.head_ref || github.ref_name }}
      TERRAFORM_APPLY: false
      ANSIBLE_APPLY: false
      LIFETIME: 1m
    secrets: inherit  
